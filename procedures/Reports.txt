DELIMITER //
CREATE PROCEDURE sales_report(IN begin_date DATE, IN end_date DATE)
BEGIN
    SELECT order_includes.product_id,product.product_name,product.price,SUM(order_includes.quantity) AS quantity,SUM(order_includes.quantity)*product.price AS total
    FROM order_includes
    INNER JOIN product
    ON product.product_id=order_includes.product_id
    WHERE order_includes.order_id <=(SELECT order_.order_id FROM order_ WHERE order_.order_date BETWEEN begin_date  AND end_date ORDER BY order_id DESC LIMIT 1)
    GROUP BY order_includes.product_id;
END //
DELIMITER ;